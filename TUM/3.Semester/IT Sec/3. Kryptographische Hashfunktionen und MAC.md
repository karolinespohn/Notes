# Kryptographische Hashfunktionen
- Kryptographische Hashfunktionen koennen fuer digitale Signaturen verwendet werden
- Dadurch kann [[1. Begriffe und Grundlagen|Datenintegritaet]] gewaehrleistet werden
## Merkle-Damgrad
- Haeufig wird fuer die Konstruktion einer Hashfunktion Merkle-Demgard verwendet
- Dabei ist eine Kompressionsfunktion gegeben:
$$f:\{0,1\}^{a + b}\to \{0, 1\}^b$$
- Mit deren Hilfe wird eine Bitfolge der Laenge $a+b$ auf eine $b$ Bit-lange Ausgabe abgebildet
- Dafuerwird die Eingabe $m$ in Bloecke zerlegt:
$$m=m_1||m_2||...||m_n$$


- Die komprimierte Nachricht wird durch die Finalisierungsfunktion in einen Hashwert umgewandelt
![[Kompressionsfunktionen.png|300]]
- Eine Schwachstelle der Merkle-Damgrad Konstruktion sind Length Extension Attacks, die unten genauer erklaert werden
# Integritaetsueberpruefungen
- Die Anforderungen an Hashfunktionen fuer Integritaetsueberpruefung lauten wiefolgt:
1. Der Hashwert/Message Digest $h = H(m)$ charakterisiert eine Nachricht $m$ eindeutig
2. Wird $m$ zu $m'$ modifiziert, so gilt $H(m') = h'$
3. Um Modifikationen zu erkennen wird gefordert, dass gilt:
$$m \neq m' \iff H(m) \neq H(m')$$
- Da $H$ nicht injektiv ist, koennen aber Kollisionen auftreten
- Deshalb wird gefordert, dass Kollisionen nicht effizient erzeugbar sein duerfen
## Anforderungen an kryptographische Hashfunktion $H$ 
-  Hashfunktionen sind effizient berechenbar
- Die Eingabe einer Hashfunktion kann nicht anhand der Ausgabe bestimmt werden
- Man fordert schwache Kollisionsresistenz, also ist es schwer zu einer Nachricht $m$ eine Nachricht $m'$ zu finden, die denselben Hashwert hat
- Man fordert starke Kollisionsresistenz, also ist es schwer ein Paar $m, m'$ zu finden, die denselben Hashwert haben
## Klassen von Hashfunktionen
- Es gibt verschiedene Wege, Hashfunktionen zu realisieren
### Basierend aud Block-Chiffren
- Ein Klartext $m$ wird mit einer Blockchiffre verschluesselt
- Der letzte Block dient als Hashwert
![[Blockchiffren als Hashfunktion.png|300]]
### Dedizierte Hashfunktionen
- Werden verwendet, um Werte zu hashen, aber nicht zur Verschluesselung
- Der Klartext wird stueckweise durch eine Bitreihe gexored und durch Funktionen permutiert
![[Dedizierte Hashfunktionen.png|300]]
### Passworthashfunktionen
- Passwoerter werden gehasht abgespeichert
- Beim Login wird die Passworteingabe gehasht und mit dem gespeicherten gehashten Passwort verglichen
- Passworthashfunktionen werden abgebremst um Brute-Force Angriffe zu vermeiden
# Message Authentication Codes (MAC)
- Der MAC dient zur Authentifizierung des Datenursprungs
- Man bringt einen shared Key $K_{AB}$ in die Hashberechnung ein, der beiden Partnern bekannt ist
- Dadurch koennen Partner verifizieren, dass die Nachricht authentisch ist
- Wichtig ist, dass "Encrypt, then MAC" verwendet wird

## Length Extension Attack
![[Kompressionsfunktionen.png]]
- Bei MAC waere zum Beispiel $m_1$ das Geheimnis, durch das ein Empfaenger den Sender Authentifiziert
- Jeder kann an die Nachricht weitere Bloecke anhaengen und damit das Geheimnis des Senders weiterverwenden
- Fuer den Empfaenger sieht es aus, als wuerden die Angehaengten Bloecke vom verifizierten Sender kommen
### HMAC Verfahren
- Das HMAC Verfahren immunisiert existierende Verfahren gegen extension Length Angriffe
$$HMAC(m,k) = H(k'\oplus opad | (H(k'\oplus ipad |m)))$$
![[HMAC.png|300]]